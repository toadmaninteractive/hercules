

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dirty Documents &mdash; Hercules Manual 2.3.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/hercules_theme.css?v=547657ed" />

  
    <link rel="shortcut icon" href="../_static/hercules.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=67b02a41"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linked Documents" href="linked-documents.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Hercules Manual
              <img src="../_static/hercules_64x64.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../designers/designers-index.html">Hercules For Designers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="developers-index.html">Hercules For Developers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Dirty Documents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dirty-document">Dirty document</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#why-you-have-to-fix-dirty-documents">Why You Have To Fix Dirty Documents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#finding-dirty-documents">Finding Dirty Documents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fixing-dirty-documents">Fixing Dirty Documents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#automatic-fixing">Automatic fixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#manual-fixing">Manual fixing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#safe-schema-updates">Safe Schema Updates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="linked-documents.html">Linked Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="localization.html">Localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="unreal.html">Hercules for Unreal Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="meta.html">Hercules Schema Meta Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripting/scripting-index.html">Scripting Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Hercules Manual</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="developers-index.html">Hercules For Developers</a></li>
      <li class="breadcrumb-item active">Dirty Documents</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dirty-documents">
<span id="id1"></span><h1>Dirty Documents<a class="headerlink" href="#dirty-documents" title="Link to this heading"></a></h1>
<p><strong>Dirty field</strong></p>
<p>A document field is dirty when its source JSON value</p>
<ul class="simple">
<li><p>is not compatible with the provided schema (invalid value)</p></li>
<li><p>is missing. In this case, the field involved is a required field that lacks a default value (missing value).</p></li>
</ul>
<section id="dirty-document">
<h2>Dirty document<a class="headerlink" href="#dirty-document" title="Link to this heading"></a></h2>
<p>A dirty document is a source JSON document that contains dirty fields.</p>
<p>A document usually becomes dirty in these scenarios:</p>
<ul class="simple">
<li><p>The document was saved directly to CouchDB by a third-party application</p></li>
<li><p>A feature that avoids schema validation (for example, database synchronization) was used to work on the document</p></li>
<li><p>The document schema got updated.</p></li>
</ul>
<section id="why-you-have-to-fix-dirty-documents">
<h3>Why You Have To Fix Dirty Documents<a class="headerlink" href="#why-you-have-to-fix-dirty-documents" title="Link to this heading"></a></h3>
<p>Client applications struggle to parse dirty documents, so you have to
fix such documents and then save them.</p>
<p>Hercules will not allow you to save a dirty document.</p>
</section>
<section id="finding-dirty-documents">
<h3>Finding Dirty Documents<a class="headerlink" href="#finding-dirty-documents" title="Link to this heading"></a></h3>
<p>To find dirty documents, use the Data / Find Invalid Documents menu
command.</p>
</section>
</section>
<section id="fixing-dirty-documents">
<h2>Fixing Dirty Documents<a class="headerlink" href="#fixing-dirty-documents" title="Link to this heading"></a></h2>
<section id="automatic-fixing">
<h3>Automatic fixing<a class="headerlink" href="#automatic-fixing" title="Link to this heading"></a></h3>
<p>When you open a dirty document, Hercules tries to fix dirty fields by
filling them with default values. The fields that get fixed
automatically are marked as <em>modified</em>. The document is also marked as
<em>modified</em>.</p>
<p>The <strong>Edit/Undo</strong> command cannot undo or reverse automatic fixes.</p>
</section>
<section id="manual-fixing">
<h3>Manual fixing<a class="headerlink" href="#manual-fixing" title="Link to this heading"></a></h3>
<p>When Hercules fails to fix a document automatically, you have to fix the
document manually.</p>
</section>
</section>
<section id="safe-schema-updates">
<h2>Safe Schema Updates<a class="headerlink" href="#safe-schema-updates" title="Link to this heading"></a></h2>
<p>A schema update or change is considered <em>safe</em> when it does not result in dirty documents.</p>
<p>These are examples of safe updates and changes:</p>
<ul class="simple">
<li><p>Adding a new optional field. A field with a missing value is okay.</p></li>
<li><p>Adding a new required field with a default value (because client JSON parsers use default values for missing fields).</p></li>
<li><p>Removing a field (because unknown/unexpected fields are ignored by client JSON parsers)</p></li>
<li><p>Changing a field type to a broader type (e.g. from integer to double; from required to optional).</p></li>
</ul>
<p>These are examples of unsafe updates and changes:</p>
<ul class="simple">
<li><p>Changing a field type to an incompatible type (e.g. from an integer to a list of integers)</p></li>
<li><p>Adding a new required field without a default value.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul>
<li><p>Schemas produced using any Igor version older than 2.0.7 do not contain information on default values for lists (empty list) and dicts (empty dictionary). For this reason, Hercules always considers new list fields dirty (even if they default to empty lists).</p></li>
<li><p>We strongly recommend you use Igor 2.0.7+ and schema version 1.1+. Hercules issues a warning when schemas produced in old program versions are loaded.</p>
<div class="highlight-igor notranslate"><div class="highlight"><pre><span></span><span class="c1">// adding required lists with empty defaults prevent Hercules from marking fields as dirty,</span>
<span class="c1">// if schema version 1.1+ is used</span>
list&lt;int&gt;<span class="w"> </span>values<span class="w"> </span>= [];
</pre></div>
</div>
</li>
</ul>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="linked-documents.html" class="btn btn-neutral float-right" title="Linked Documents" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Toadman Interactive.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>